{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/KIIT/Desktop/dev-community/frontend/services/api.js"],"sourcesContent":["// next-app/services/api.js\r\nimport axios from 'axios';\r\n\r\nconst instance = axios.create({\r\n  baseURL: process.env.NEXT_PUBLIC_API_BASE,\r\n  withCredentials: false, // optional, enable if you use cookies\r\n});\r\n\r\nexport default instance;\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;AAC3B;;;;;;AAEA,MAAM,WAAW,0GAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IAC5B,OAAO;IACP,iBAAiB;AACnB;uCAEe","debugId":null}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/KIIT/Desktop/dev-community/frontend/components/CommentList.js"],"sourcesContent":["// next-app/components/CommentList.js\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport axios from '../services/api';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nexport default function CommentList({ comments, onCommentDeleted }) {\r\n  const { user, isAuthenticated } = useAuth();\r\n\r\n  const handleDeleteComment = async (commentId) => {\r\n    if (!window.confirm('Are you sure you want to delete this comment?')) {\r\n      return;\r\n    }\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      // --- FIX THIS LINE ---\r\n      await axios.delete(`/comments/${commentId}`, {\r\n        headers: { Authorization: `Bearer ${token}` }, // Add 'Bearer' prefix\r\n      });\r\n      // --- END FIX ---\r\n      alert('Comment deleted successfully!');\r\n      if (onCommentDeleted) {\r\n        onCommentDeleted(commentId);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting comment:', error.response?.data || error.message);\r\n      alert(error.response?.data?.error || 'Failed to delete comment!');\r\n    }\r\n  };\r\n\r\n  if (!comments || comments.length === 0) {\r\n    return <p className=\"text-gray-500 italic mt-4\">Add a comment</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-6 bg-white p-4 rounded-lg shadow-sm\">\r\n      <h3 className=\"text-xl font-bold mb-4 text-gray-800\">Comments ({comments.length})</h3>\r\n      <ul className=\"space-y-4\">\r\n        {comments.map(comment => {\r\n          const isCommentAuthor = isAuthenticated && user && comment.author && user._id === comment.author._id;\r\n\r\n          return (\r\n            <li key={comment._id} className=\"border-b border-gray-200 pb-4 last:border-b-0\">\r\n              <div className=\"flex items-center text-sm text-gray-600 mb-1\">\r\n                <span className=\"font-semibold text-blue-700\">{comment.author?.username || 'Anonymous'}</span>\r\n                <span className=\"mx-2\">•</span>\r\n                <span>{formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}</span>\r\n                {isCommentAuthor && (\r\n                  <button onClick={() => handleDeleteComment(comment._id)}\r\n                    className=\"ml-4 bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600\">\r\n                    Delete\r\n                  </button>\r\n                )}\r\n              </div>\r\n              <ReactMarkdown remarkPlugins={[remarkGfm]}>{comment.contentMarkdown}</ReactMarkdown>\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,qCAAqC;;;;;AACrC;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AAEe,SAAS,YAAY,EAAE,QAAQ,EAAE,gBAAgB,EAAE;IAChE,MAAM,EAAE,IAAI,EAAE,eAAe,EAAE,GAAG,CAAA,GAAA,+GAAA,CAAA,UAAO,AAAD;IAExC,MAAM,sBAAsB,OAAO;QACjC,IAAI,CAAC,OAAO,OAAO,CAAC,kDAAkD;YACpE;QACF;QACA,IAAI;YACF,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,wBAAwB;YACxB,MAAM,wGAAA,CAAA,UAAK,CAAC,MAAM,CAAC,CAAC,UAAU,EAAE,WAAW,EAAE;gBAC3C,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAC9C;YACA,kBAAkB;YAClB,MAAM;YACN,IAAI,kBAAkB;gBACpB,iBAAiB;YACnB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B,MAAM,QAAQ,EAAE,QAAQ,MAAM,OAAO;YAC9E,MAAM,MAAM,QAAQ,EAAE,MAAM,SAAS;QACvC;IACF;IAEA,IAAI,CAAC,YAAY,SAAS,MAAM,KAAK,GAAG;QACtC,qBAAO,qKAAC;YAAE,WAAU;sBAA4B;;;;;;IAClD;IAEA,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAG,WAAU;;oBAAuC;oBAAW,SAAS,MAAM;oBAAC;;;;;;;0BAChF,qKAAC;gBAAG,WAAU;0BACX,SAAS,GAAG,CAAC,CAAA;oBACZ,MAAM,kBAAkB,mBAAmB,QAAQ,QAAQ,MAAM,IAAI,KAAK,GAAG,KAAK,QAAQ,MAAM,CAAC,GAAG;oBAEpG,qBACE,qKAAC;wBAAqB,WAAU;;0CAC9B,qKAAC;gCAAI,WAAU;;kDACb,qKAAC;wCAAK,WAAU;kDAA+B,QAAQ,MAAM,EAAE,YAAY;;;;;;kDAC3E,qKAAC;wCAAK,WAAU;kDAAO;;;;;;kDACvB,qKAAC;kDAAM,CAAA,GAAA,2IAAA,CAAA,sBAAmB,AAAD,EAAE,IAAI,KAAK,QAAQ,SAAS,GAAG;4CAAE,WAAW;wCAAK;;;;;;oCACzE,iCACC,qKAAC;wCAAO,SAAS,IAAM,oBAAoB,QAAQ,GAAG;wCACpD,WAAU;kDAAwE;;;;;;;;;;;;0CAKxF,qKAAC,kIAAA,CAAA,UAAa;gCAAC,eAAe;oCAAC,0HAAA,CAAA,UAAS;iCAAC;0CAAG,QAAQ,eAAe;;;;;;;uBAZ5D,QAAQ,GAAG;;;;;gBAexB;;;;;;;;;;;;AAIR","debugId":null}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/KIIT/Desktop/dev-community/frontend/components/CommentForm.js"],"sourcesContent":["import { useState } from 'react';\r\nimport axios from '../services/api'; \r\n// import { useRouter } from 'next/router'; \r\n// const router = useRouter();\r\n\r\nexport default function CommentForm({ postId, onCommentAdded }) {\r\n  const [content, setContent] = useState('');\r\n\r\n  const handleSubmit = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      alert('Please log in to add a comment!');\r\n      return;\r\n    }\r\n    try {\r\n      const res = await axios.post(`/comments/${postId}`, { contentMarkdown: content }, {\r\n        headers: { Authorization: `Bearer ${token}` }, \r\n      });\r\n      setContent('');\r\n      onCommentAdded(res.data);\r\n      // router.push('/');\r\n    } catch (error) {\r\n      console.error('Error posting comment:', error.response?.data || error.message);\r\n      alert('Failed to post comment. Please try again.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"mt-4 p-4 border rounded-lg bg-white shadow-sm\">\r\n      <h4 className=\"font-semibold mb-2 text-gray-700\">Leave a Comment</h4>\r\n      <textarea\r\n        className=\"border border-gray-300 rounded p-3 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200\"\r\n        rows=\"4\"\r\n        placeholder=\"What are your thoughts? (Markdown supported)\"\r\n        value={content}\r\n        onChange={e => setContent(e.target.value)}\r\n      />\r\n      <button\r\n        className=\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-3 transition duration-300 ease-in-out\"\r\n        onClick={handleSubmit}\r\n      >\r\n        Post Comment\r\n      </button>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;;AAIe,SAAS,YAAY,EAAE,MAAM,EAAE,cAAc,EAAE;IAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,MAAM,eAAe;QACnB,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,CAAC,OAAO;YACV,MAAM;YACN;QACF;QACA,IAAI;YACF,MAAM,MAAM,MAAM,wGAAA,CAAA,UAAK,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,QAAQ,EAAE;gBAAE,iBAAiB;YAAQ,GAAG;gBAChF,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAC9C;YACA,WAAW;YACX,eAAe,IAAI,IAAI;QACvB,oBAAoB;QACtB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B,MAAM,QAAQ,EAAE,QAAQ,MAAM,OAAO;YAC7E,MAAM;QACR;IACF;IAEA,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAG,WAAU;0BAAmC;;;;;;0BACjD,qKAAC;gBACC,WAAU;gBACV,MAAK;gBACL,aAAY;gBACZ,OAAO;gBACP,UAAU,CAAA,IAAK,WAAW,EAAE,MAAM,CAAC,KAAK;;;;;;0BAE1C,qKAAC;gBACC,WAAU;gBACV,SAAS;0BACV;;;;;;;;;;;;AAKP","debugId":null}},
    {"offset": {"line": 330, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/KIIT/Desktop/dev-community/frontend/pages/post/%5Bid%5D.js"],"sourcesContent":["// next-app/pages/post/[id].js\r\nimport CommentList from '../../components/CommentList';\r\nimport CommentForm from '../../components/CommentForm';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect, useState } from 'react';\r\nimport axios from '../../services/api';\r\nimport { formatDistanceToNow } from 'date-fns'; // Import for date formatting\r\n\r\nexport default function PostDetail() {\r\n  const router = useRouter();\r\n  const { id } = router.query;\r\n  const [post, setPost] = useState(null);\r\n  const [comments, setComments] = useState([]);\r\n  const [currentUserId, setCurrentUserId] = useState(null); // State for current user ID\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      // Fetch post details\r\n      axios.get(`/posts/${id}`)\r\n        .then(res => setPost(res.data))\r\n        .catch(err => console.error(\"Error fetching post:\", err));\r\n\r\n      // Fetch comments for the post\r\n      axios.get(`/comments/${id}`)\r\n        .then(res => setComments(res.data))\r\n        .catch(err => console.error(\"Error fetching comments:\", err));\r\n\r\n      // Get current user ID from localStorage\r\n      const storedUser = localStorage.getItem('user');\r\n      if (storedUser) {\r\n        try {\r\n          setCurrentUserId(JSON.parse(storedUser)._id);\r\n        } catch (e) {\r\n          console.error(\"Failed to parse user from localStorage:\", e);\r\n          setCurrentUserId(null);\r\n        }\r\n      }\r\n    }\r\n  }, [id]); // Dependency array includes 'id'\r\n\r\n  if (!post) return <p>Loading post...</p>;\r\n\r\n  // Derived state for voting UI\r\n  const voteCount = post.upvotes.length - post.downvotes.length;\r\n  const hasUpvoted = currentUserId && post.upvotes.includes(currentUserId);\r\n  const hasDownvoted = currentUserId && post.downvotes.includes(currentUserId);\r\n\r\n  const handleVote = async (voteType) => { // voteType will be 'upvote' or 'downvote'\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      alert('Please log in to vote!');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const endpoint = `/posts/${post._id}/${voteType}`;\r\n      const res = await axios.post(endpoint, {}, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setPost(res.data); // Update post state with new data from backend\r\n    } catch (error) {\r\n      console.error(`Error ${voteType}ing post:`, error.response?.data || error.message);\r\n      alert(`Failed to ${voteType} post. Please try again.`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4 max-w-2xl mx-auto\">\r\n      <div className=\"flex bg-white rounded-lg shadow-md mb-6 border border-gray-200\">\r\n        {/* Vote Column */}\r\n        <div className=\"flex flex-col items-center p-2 bg-gray-50 rounded-l-lg border-r border-gray-100\">\r\n          <button\r\n            onClick={() => handleVote('upvote')}\r\n            className={`text-gray-500 hover:text-orange-500 ${hasUpvoted ? 'text-orange-500' : ''}`}\r\n            aria-label=\"Upvote\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 4l8 8H4l8-8z\"/></svg>\r\n          </button>\r\n          <span className=\"font-bold text-md py-1 text-gray-800\">{voteCount}</span>\r\n          <button\r\n            onClick={() => handleVote('downvote')}\r\n            className={`text-gray-500 hover:text-blue-500 ${hasDownvoted ? 'text-blue-500' : ''}`}\r\n            aria-label=\"Downvote\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M12 20l-8-8h16l-8 8z\"/></svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content Column */}\r\n        <div className=\"flex-1 p-4\">\r\n          <div className=\"flex items-center text-sm text-gray-600 mb-2\">\r\n            <span className=\"font-semibold text-gray-700\">Posted by u/{post.author?.username || 'Anonymous'}</span>\r\n            <span className=\"mx-2\">•</span>\r\n            <span>{formatDistanceToNow(new Date(post.createdAt), { addSuffix: true })}</span>\r\n          </div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2 leading-tight\">{post.title}</h1>\r\n          <p className=\"text-gray-700 text-base mb-4\">{post.contentMarkdown}</p>\r\n\r\n          <div className=\"flex items-center text-sm text-gray-600\">\r\n            <span className=\"flex items-center\">\r\n              <svg className=\"w-5 h-5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z\"></path></svg>\r\n              <span className=\"font-semibold\">{comments.length || 0} Comments</span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <h3 className=\"text-lg font-semibold mt-6 mb-3\">Comments</h3>\r\n      <CommentList comments={comments} />\r\n      <CommentForm postId={id} onCommentAdded={comment => setComments(prev => [...prev, comment])} />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}